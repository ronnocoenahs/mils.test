{% extends "base.html" %}

{% block title %}{{ title }} - SlimFlix{% endblock %}

{% block content %}
<div class="p-4 md:p-8">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-bold text-white">{{ title }}</h2>
        <form action="{{ url_for('scan_library_route') }}" method="post">
             <button type="submit" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center space-x-2 text-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.899 2.101V3a1 1 0 112 0v2.101a7.002 7.002 0 01-5.899 6.798V17a1 1 0 11-2 0v-2.101A7.002 7.002 0 014 8.101V17a1 1 0 11-2 0V8.101A7.002 7.002 0 014.101 5.1V3a1 1 0 01-1-1zM10 14a5 5 0 100-10 5 5 0 000 10z" clip-rule="evenodd" />
                </svg>
                <span>Scan Directories</span>
            </button>
        </form>
    </div>

    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
        {% for item in items %}
            {% set detail_url = url_for('movie_detail_page', movie_id=item.id) if media_type == 'movie' else url_for('tv_show_detail_page', show_id=item.id) %}
            <a href="{{ detail_url }}" class="poster-card">
                <img src="{{ item.poster or 'https://placehold.co/300x450/181818/e0e0e0?text=No+Poster' }}" alt="{{ item.title }} Poster" loading="lazy">
                <div class="info">
                    <h4 class="title">{{ item.title }}</h4>
                    <p class="year">{{ (item.release_date.split('-')[0]) if item.release_date else item.year }}</p>
                </div>
            </a>
        {% else %}
            <p class="text-gray-400 col-span-full">No media found in this library. Try scanning the directories.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}

