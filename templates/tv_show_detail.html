{% extends "base.html" %}

{% block title %}{{ show.title }} - SlimFlix{% endblock %}

{% block content %}
<div class="relative">
    <!-- Backdrop Image -->
    <div class="h-96 bg-cover bg-center" style="background-image: linear-gradient(to bottom, rgba(17, 24, 39, 0.6), rgba(17, 24, 39, 1)), url('{{ show.backdrop_path }}');">
    </div>

    <div class="container mx-auto px-4 -mt-48">
        <div class="flex flex-col md:flex-row">
            <!-- Poster Image -->
            <div class="flex-shrink-0 w-64 mx-auto md:mx-0">
                <img src="{{ show.poster }}" alt="{{ show.title }} Poster" class="rounded-lg shadow-2xl">
            </div>

            <!-- TV Show Details -->
            <div class="md:ml-8 mt-8 md:mt-0 text-white flex-grow">
                <h1 class="text-4xl font-bold">{{ show.title }}</h1>
                
                <div class="flex items-center my-4">
                    <span class="text-yellow-400 font-bold text-xl mr-4">{{ (show.vote_average or 0)|round(1) }}/10</span>
                    <span class="text-gray-400">{{ show.release_date }}</span>
                </div>

                <p class="my-4 leading-relaxed">{{ show.overview }}</p>

            </div>
        </div>
    </div>

    <!-- Seasons and Episodes -->
    <div class="container mx-auto px-4 mt-12">
        <h2 class="text-3xl font-bold text-white mb-6">Seasons</h2>
        <div class="space-y-4">
            {% for season_num, episodes in show.seasons.items()|sort %}
                <details class="bg-gray-800 p-4 rounded-lg" {% if loop.first %}open{% endif %}>
                    <summary class="font-semibold text-xl text-teal-400 cursor-pointer">
                        Season {{ season_num }}
                    </summary>
                    <ul class="mt-4 space-y-2">
                        {% for episode in episodes %}
                        <li class="bg-gray-700/50 p-3 rounded-md flex justify-between items-center">
                            <div>
                                <p class="font-semibold text-white">E{{ episode.episode }}: {{ episode.episode_title }}</p>
                                <p class="text-sm text-gray-400 mt-1">{{ episode.episode_overview }}</p>
                            </div>
                            <a href="{{ url_for('stream_media', file_path=episode.path) }}" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-1 px-3 rounded text-sm flex-shrink-0 ml-4">Play</a>
                        </li>
                        {% endfor %}
                    </ul>
                </details>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

